module Lib where
import Servant
import Servant.API
import Network.Wai.Handler.Warp
import Codec.Picture.Types
import Codec.Picture
import Pixels
import Models
import Htmls
import Api
import Control.Concurrent.STM
import Control.Monad
import Control.Monad.Trans

imagApp :: IO ()
imagApp = do
  left <- atomically $ newTVar $ ImageRGB8 $ generateImage (const.const $ PixelRGB8 0 200 0) 300 300
  right <- atomically $ newTVar $ ImageRGB8 $ generateImage (const.const $ PixelRGB8 0 0 0) 300 300
  run 8080 $ serve imageApi (zipSrv left right)
